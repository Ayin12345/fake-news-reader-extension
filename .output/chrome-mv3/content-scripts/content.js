var content=function(){"use strict";var M=Object.defineProperty;var L=(d,i,h)=>i in d?M(d,i,{enumerable:!0,configurable:!0,writable:!0,value:h}):d[i]=h;var c=(d,i,h)=>L(d,typeof i!="symbol"?i+"":i,h);var N,C;function d(n){return n}const i={matches:["<all_urls>"],main(){console.log("Content script loaded"),chrome.runtime.onMessage.addListener((t,e,r)=>{if(t.type==="GET_PAGE_CONTENT")return console.log("Processing content on:",window.location.href),document.readyState!=="complete"?(console.log("Page not ready, waiting..."),window.addEventListener("load",()=>{setTimeout(()=>{n(r)},100)}),!0):(setTimeout(()=>{n(r)},100),!0)});function n(t){try{let e=document.querySelector("article");if(!e){const a=['[role="main"]',".article-content",".story-content",".post-content",".entry-content","main",".content"];for(const f of a)if(e=document.querySelector(f),e){console.log("Found content using selector:",f);break}}if(!e){t({error:"Not a news article."});return}const r=e.cloneNode(!0);r.querySelectorAll("script, style, noscript").forEach(a=>a.remove()),["nav","header","footer",".navigation",".nav",".menu",".sidebar",".related",".share",".social",".breadcrumb",'[role="navigation"]','[role="banner"]','[role="contentinfo"]',".tags",".categories",".metadata",".byline",".author-info",".related-terms",".details",".share-buttons",".advertisement",".ad",".ads",".promo",".trending",".more-stories",".recommended",".newsletter",".subscription",".toolbar",".comments",".social-share",".video-player",".caas-carousel",".caas-readmore",".caas-attr-meta","[data-module]",".video-container",".photo-credit",".story-meta",".story-byline",".story-timestamp"].forEach(a=>{r.querySelectorAll(a).forEach(f=>f.remove())});const o=r.querySelectorAll("p");let l="";o.length>0&&o.forEach((a,f)=>{const E=a.innerText.trim();E.length>50&&!E.includes("Advertisement")&&!E.includes("Â©")&&(l+=E+" ")}),l.length<200&&(l=r.innerText||"");const u=r.querySelectorAll("a").length;let y=l.replace(/\s+/g," ").replace(/\n\s*\n/g,`
`).trim();const g=y.split(/\s+/).filter(a=>a.length>0).length;if(console.log("Word count:",g,"Link count:",u),console.log("Content:",y),g<100||u>35||g>1250){t({error:"Not a valid article: must have 100-1250 words and no more than 35 content links. This article has "+g+" words and "+u+" links."});return}const q={title:document.title,content:y,url:window.location.href,wordCount:g};t({success:!0,data:q})}catch(e){console.error("Content script error:",e),t({error:"Failed to extract page content."})}}}},v=(C=(N=globalThis.browser)==null?void 0:N.runtime)!=null&&C.id?globalThis.browser:globalThis.chrome;function w(n,...t){}const A={debug:(...n)=>w(console.debug,...n),log:(...n)=>w(console.log,...n),warn:(...n)=>w(console.warn,...n),error:(...n)=>w(console.error,...n)},S=class S extends Event{constructor(t,e){super(S.EVENT_NAME,{}),this.newUrl=t,this.oldUrl=e}};c(S,"EVENT_NAME",T("wxt:locationchange"));let b=S;function T(n){var t;return`${(t=v==null?void 0:v.runtime)==null?void 0:t.id}:content:${n}`}function F(n){let t,e;return{run(){t==null&&(e=new URL(location.href),t=n.setInterval(()=>{let r=new URL(location.href);r.href!==e.href&&(window.dispatchEvent(new b(r,e)),e=r)},1e3))}}}const m=class m{constructor(t,e){c(this,"isTopFrame",window.self===window.top);c(this,"abortController");c(this,"locationWatcher",F(this));c(this,"receivedMessageIds",new Set);this.contentScriptName=t,this.options=e,this.abortController=new AbortController,this.isTopFrame?(this.listenForNewerScripts({ignoreFirstEvent:!0}),this.stopOldScripts()):this.listenForNewerScripts()}get signal(){return this.abortController.signal}abort(t){return this.abortController.abort(t)}get isInvalid(){return v.runtime.id==null&&this.notifyInvalidated(),this.signal.aborted}get isValid(){return!this.isInvalid}onInvalidated(t){return this.signal.addEventListener("abort",t),()=>this.signal.removeEventListener("abort",t)}block(){return new Promise(()=>{})}setInterval(t,e){const r=setInterval(()=>{this.isValid&&t()},e);return this.onInvalidated(()=>clearInterval(r)),r}setTimeout(t,e){const r=setTimeout(()=>{this.isValid&&t()},e);return this.onInvalidated(()=>clearTimeout(r)),r}requestAnimationFrame(t){const e=requestAnimationFrame((...r)=>{this.isValid&&t(...r)});return this.onInvalidated(()=>cancelAnimationFrame(e)),e}requestIdleCallback(t,e){const r=requestIdleCallback((...s)=>{this.signal.aborted||t(...s)},e);return this.onInvalidated(()=>cancelIdleCallback(r)),r}addEventListener(t,e,r,s){var o;e==="wxt:locationchange"&&this.isValid&&this.locationWatcher.run(),(o=t.addEventListener)==null||o.call(t,e.startsWith("wxt:")?T(e):e,r,{...s,signal:this.signal})}notifyInvalidated(){this.abort("Content script context invalidated"),A.debug(`Content script "${this.contentScriptName}" context invalidated`)}stopOldScripts(){window.postMessage({type:m.SCRIPT_STARTED_MESSAGE_TYPE,contentScriptName:this.contentScriptName,messageId:Math.random().toString(36).slice(2)},"*")}verifyScriptStartedEvent(t){var o,l,u;const e=((o=t.data)==null?void 0:o.type)===m.SCRIPT_STARTED_MESSAGE_TYPE,r=((l=t.data)==null?void 0:l.contentScriptName)===this.contentScriptName,s=!this.receivedMessageIds.has((u=t.data)==null?void 0:u.messageId);return e&&r&&s}listenForNewerScripts(t){let e=!0;const r=s=>{if(this.verifyScriptStartedEvent(s)){this.receivedMessageIds.add(s.data.messageId);const o=e;if(e=!1,o&&(t!=null&&t.ignoreFirstEvent))return;this.notifyInvalidated()}};addEventListener("message",r),this.onInvalidated(()=>removeEventListener("message",r))}};c(m,"SCRIPT_STARTED_MESSAGE_TYPE",T("wxt:content-script-started"));let I=m;function k(){}function p(n,...t){}const P={debug:(...n)=>p(console.debug,...n),log:(...n)=>p(console.log,...n),warn:(...n)=>p(console.warn,...n),error:(...n)=>p(console.error,...n)};return(async()=>{try{const{main:n,...t}=i,e=new I("content",t);return await n(e)}catch(n){throw P.error('The content script "content" crashed on startup!',n),n}})()}();
content;
