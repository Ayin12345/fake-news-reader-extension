var content=function(){"use strict";var k=Object.defineProperty;var x=(d,i,u)=>i in d?k(d,i,{enumerable:!0,configurable:!0,writable:!0,value:u}):d[i]=u;var c=(d,i,u)=>x(d,typeof i!="symbol"?i+"":i,u);var A,C;function d(r){return r}const i={matches:["<all_urls>"],main(){console.log("Content script loaded"),chrome.runtime.onMessage.addListener((r,t,e)=>{if(r.type==="GET_PAGE_CONTENT"){console.log("Processing content on:",window.location.href);try{let n=document.querySelector("article");if(!n){const s=['[role="main"]',".article-content",".story-content",".post-content",".entry-content","main",".content"];for(const f of s)if(n=document.querySelector(f),n){console.log("Found content using selector:",f);break}}if(!n)return e({error:"Not a news article."}),!0;const o=n.cloneNode(!0);o.querySelectorAll("script, style, noscript").forEach(s=>s.remove()),["nav","header","footer",".navigation",".nav",".menu",".sidebar",".related",".share",".social",".breadcrumb",'[role="navigation"]','[role="banner"]','[role="contentinfo"]',".tags",".categories",".metadata",".byline",".author-info",".related-terms",".details",".share-buttons",".advertisement",".ad",".ads",".promo",".trending",".more-stories",".recommended",".newsletter",".subscription",".toolbar",".comments",".social-share",".video-player",".caas-carousel",".caas-readmore",".caas-attr-meta","[data-module]",".video-container",".photo-credit",".story-meta",".story-byline",".story-timestamp"].forEach(s=>{o.querySelectorAll(s).forEach(f=>f.remove())});const m=o.querySelectorAll("p");let l="";m.length>0&&m.forEach((s,f)=>{const b=s.innerText.trim();b.length>50&&!b.includes("Advertisement")&&!b.includes("Â©")&&(l+=b+" ")}),l.length<200&&(l=o.innerText||"");const y=o.querySelectorAll("a").length;let N=l.replace(/\s+/g," ").replace(/\n\s*\n/g,`
`).trim();const g=N.split(/\s+/).filter(s=>s.length>0).length;if(console.log("Word count:",g,"Link count:",y),console.log("Content:",N),g<100||y>35||g>1250)return e({error:"Not a valid article: must have 100-1250 words and no more than 35 content links. This article has "+g+" words and "+y+" links."}),!0;const P={title:document.title,content:N,url:window.location.href,wordCount:g};return e({success:!0,data:P}),!0}catch(n){return console.error("Content script error:",n),e({error:"Failed to extract page content."}),!0}}})}},v=(C=(A=globalThis.browser)==null?void 0:A.runtime)!=null&&C.id?globalThis.browser:globalThis.chrome;function p(r,...t){}const F={debug:(...r)=>p(console.debug,...r),log:(...r)=>p(console.log,...r),warn:(...r)=>p(console.warn,...r),error:(...r)=>p(console.error,...r)},S=class S extends Event{constructor(t,e){super(S.EVENT_NAME,{}),this.newUrl=t,this.oldUrl=e}};c(S,"EVENT_NAME",T("wxt:locationchange"));let E=S;function T(r){var t;return`${(t=v==null?void 0:v.runtime)==null?void 0:t.id}:content:${r}`}function q(r){let t,e;return{run(){t==null&&(e=new URL(location.href),t=r.setInterval(()=>{let n=new URL(location.href);n.href!==e.href&&(window.dispatchEvent(new E(n,e)),e=n)},1e3))}}}const h=class h{constructor(t,e){c(this,"isTopFrame",window.self===window.top);c(this,"abortController");c(this,"locationWatcher",q(this));c(this,"receivedMessageIds",new Set);this.contentScriptName=t,this.options=e,this.abortController=new AbortController,this.isTopFrame?(this.listenForNewerScripts({ignoreFirstEvent:!0}),this.stopOldScripts()):this.listenForNewerScripts()}get signal(){return this.abortController.signal}abort(t){return this.abortController.abort(t)}get isInvalid(){return v.runtime.id==null&&this.notifyInvalidated(),this.signal.aborted}get isValid(){return!this.isInvalid}onInvalidated(t){return this.signal.addEventListener("abort",t),()=>this.signal.removeEventListener("abort",t)}block(){return new Promise(()=>{})}setInterval(t,e){const n=setInterval(()=>{this.isValid&&t()},e);return this.onInvalidated(()=>clearInterval(n)),n}setTimeout(t,e){const n=setTimeout(()=>{this.isValid&&t()},e);return this.onInvalidated(()=>clearTimeout(n)),n}requestAnimationFrame(t){const e=requestAnimationFrame((...n)=>{this.isValid&&t(...n)});return this.onInvalidated(()=>cancelAnimationFrame(e)),e}requestIdleCallback(t,e){const n=requestIdleCallback((...o)=>{this.signal.aborted||t(...o)},e);return this.onInvalidated(()=>cancelIdleCallback(n)),n}addEventListener(t,e,n,o){var a;e==="wxt:locationchange"&&this.isValid&&this.locationWatcher.run(),(a=t.addEventListener)==null||a.call(t,e.startsWith("wxt:")?T(e):e,n,{...o,signal:this.signal})}notifyInvalidated(){this.abort("Content script context invalidated"),F.debug(`Content script "${this.contentScriptName}" context invalidated`)}stopOldScripts(){window.postMessage({type:h.SCRIPT_STARTED_MESSAGE_TYPE,contentScriptName:this.contentScriptName,messageId:Math.random().toString(36).slice(2)},"*")}verifyScriptStartedEvent(t){var a,m,l;const e=((a=t.data)==null?void 0:a.type)===h.SCRIPT_STARTED_MESSAGE_TYPE,n=((m=t.data)==null?void 0:m.contentScriptName)===this.contentScriptName,o=!this.receivedMessageIds.has((l=t.data)==null?void 0:l.messageId);return e&&n&&o}listenForNewerScripts(t){let e=!0;const n=o=>{if(this.verifyScriptStartedEvent(o)){this.receivedMessageIds.add(o.data.messageId);const a=e;if(e=!1,a&&(t!=null&&t.ignoreFirstEvent))return;this.notifyInvalidated()}};addEventListener("message",n),this.onInvalidated(()=>removeEventListener("message",n))}};c(h,"SCRIPT_STARTED_MESSAGE_TYPE",T("wxt:content-script-started"));let I=h;function L(){}function w(r,...t){}const M={debug:(...r)=>w(console.debug,...r),log:(...r)=>w(console.log,...r),warn:(...r)=>w(console.warn,...r),error:(...r)=>w(console.error,...r)};return(async()=>{try{const{main:r,...t}=i,e=new I("content",t);return await r(e)}catch(r){throw M.error('The content script "content" crashed on startup!',r),r}})()}();
content;
