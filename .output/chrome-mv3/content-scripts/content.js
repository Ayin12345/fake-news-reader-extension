var content=function(){"use strict";var x=Object.defineProperty;var L=(d,i,u)=>i in d?x(d,i,{enumerable:!0,configurable:!0,writable:!0,value:u}):d[i]=u;var c=(d,i,u)=>L(d,typeof i!="symbol"?i+"":i,u);var N,C;function d(n){return n}const i={matches:["<all_urls>"],main(){console.log("Content script loaded"),chrome.runtime.onMessage.addListener((n,t,e)=>{if(n.type==="GET_PAGE_CONTENT"){console.log("Processing content on:",window.location.href);try{let r=document.querySelector("article");if(!r){const s=['[role="main"]',".article-content",".story-content",".post-content",".entry-content","main",".content"];for(const f of s)if(r=document.querySelector(f),r){console.log("Found content using selector:",f);break}}if(!r)return e({error:"Not a news article."}),!0;const o=r.cloneNode(!0);o.querySelectorAll("script, style, noscript").forEach(s=>s.remove()),["nav","header","footer",".navigation",".nav",".menu",".sidebar",".related",".share",".social",".breadcrumb",'[role="navigation"]','[role="banner"]','[role="contentinfo"]',".tags",".categories",".metadata",".byline",".author-info",".related-terms",".details",".share-buttons",".advertisement",".ad",".ads",".promo",".trending",".more-stories",".recommended",".newsletter",".subscription",".toolbar",".comments",".social-share",".video-player",".caas-carousel",".caas-readmore",".caas-attr-meta","[data-module]",".video-container",".photo-credit",".story-meta",".story-byline",".story-timestamp"].forEach(s=>{o.querySelectorAll(s).forEach(f=>f.remove())});const m=o.querySelectorAll("p");let l="";m.length>0&&m.forEach((s,f)=>{const E=s.innerText.trim();E.length>50&&!E.includes("Advertisement")&&!E.includes("Â©")&&(l+=E+" ")}),l.length<200&&(l=o.innerText||"");const A=o.querySelectorAll("a").length;let g=l.replace(/\s+/g," ").replace(/\n\s*\n/g,`
`).trim();console.log("Content after cleaning:",g.length,"chars"),console.log("First 200 chars after cleaning:",g.substring(0,200));const S=g.split(/\s+/).filter(s=>s.length>0).length;if(console.log("Word count:",S,"Link count:",A),console.log("Content preview (first 300 chars):",g.substring(0,300)),S<100||A>35||S>1250)return e({error:"Not a valid article: must have 100-1250 words and no more than 35 content links."}),!0;const P={title:document.title,content:g,url:window.location.href,wordCount:S};return e({success:!0,data:P}),!0}catch(r){return console.error("Content script error:",r),e({error:"Failed to extract page content."}),!0}}})}},v=(C=(N=globalThis.browser)==null?void 0:N.runtime)!=null&&C.id?globalThis.browser:globalThis.chrome;function p(n,...t){}const F={debug:(...n)=>p(console.debug,...n),log:(...n)=>p(console.log,...n),warn:(...n)=>p(console.warn,...n),error:(...n)=>p(console.error,...n)},b=class b extends Event{constructor(t,e){super(b.EVENT_NAME,{}),this.newUrl=t,this.oldUrl=e}};c(b,"EVENT_NAME",I("wxt:locationchange"));let T=b;function I(n){var t;return`${(t=v==null?void 0:v.runtime)==null?void 0:t.id}:content:${n}`}function q(n){let t,e;return{run(){t==null&&(e=new URL(location.href),t=n.setInterval(()=>{let r=new URL(location.href);r.href!==e.href&&(window.dispatchEvent(new T(r,e)),e=r)},1e3))}}}const h=class h{constructor(t,e){c(this,"isTopFrame",window.self===window.top);c(this,"abortController");c(this,"locationWatcher",q(this));c(this,"receivedMessageIds",new Set);this.contentScriptName=t,this.options=e,this.abortController=new AbortController,this.isTopFrame?(this.listenForNewerScripts({ignoreFirstEvent:!0}),this.stopOldScripts()):this.listenForNewerScripts()}get signal(){return this.abortController.signal}abort(t){return this.abortController.abort(t)}get isInvalid(){return v.runtime.id==null&&this.notifyInvalidated(),this.signal.aborted}get isValid(){return!this.isInvalid}onInvalidated(t){return this.signal.addEventListener("abort",t),()=>this.signal.removeEventListener("abort",t)}block(){return new Promise(()=>{})}setInterval(t,e){const r=setInterval(()=>{this.isValid&&t()},e);return this.onInvalidated(()=>clearInterval(r)),r}setTimeout(t,e){const r=setTimeout(()=>{this.isValid&&t()},e);return this.onInvalidated(()=>clearTimeout(r)),r}requestAnimationFrame(t){const e=requestAnimationFrame((...r)=>{this.isValid&&t(...r)});return this.onInvalidated(()=>cancelAnimationFrame(e)),e}requestIdleCallback(t,e){const r=requestIdleCallback((...o)=>{this.signal.aborted||t(...o)},e);return this.onInvalidated(()=>cancelIdleCallback(r)),r}addEventListener(t,e,r,o){var a;e==="wxt:locationchange"&&this.isValid&&this.locationWatcher.run(),(a=t.addEventListener)==null||a.call(t,e.startsWith("wxt:")?I(e):e,r,{...o,signal:this.signal})}notifyInvalidated(){this.abort("Content script context invalidated"),F.debug(`Content script "${this.contentScriptName}" context invalidated`)}stopOldScripts(){window.postMessage({type:h.SCRIPT_STARTED_MESSAGE_TYPE,contentScriptName:this.contentScriptName,messageId:Math.random().toString(36).slice(2)},"*")}verifyScriptStartedEvent(t){var a,m,l;const e=((a=t.data)==null?void 0:a.type)===h.SCRIPT_STARTED_MESSAGE_TYPE,r=((m=t.data)==null?void 0:m.contentScriptName)===this.contentScriptName,o=!this.receivedMessageIds.has((l=t.data)==null?void 0:l.messageId);return e&&r&&o}listenForNewerScripts(t){let e=!0;const r=o=>{if(this.verifyScriptStartedEvent(o)){this.receivedMessageIds.add(o.data.messageId);const a=e;if(e=!1,a&&(t!=null&&t.ignoreFirstEvent))return;this.notifyInvalidated()}};addEventListener("message",r),this.onInvalidated(()=>removeEventListener("message",r))}};c(h,"SCRIPT_STARTED_MESSAGE_TYPE",I("wxt:content-script-started"));let y=h;function _(){}function w(n,...t){}const M={debug:(...n)=>w(console.debug,...n),log:(...n)=>w(console.log,...n),warn:(...n)=>w(console.warn,...n),error:(...n)=>w(console.error,...n)};return(async()=>{try{const{main:n,...t}=i,e=new y("content",t);return await n(e)}catch(n){throw M.error('The content script "content" crashed on startup!',n),n}})()}();
content;
