var content=function(){"use strict";var B=Object.defineProperty;var W=(y,u,S)=>u in y?B(y,u,{enumerable:!0,configurable:!0,writable:!0,value:S}):y[u]=S;var f=(y,u,S)=>W(y,typeof u!="symbol"?u+"":u,S);var P,_;function y(i){return i}const u={matches:["<all_urls>"],exclude_matches:["chrome://*","chrome-extension://*","moz-extension://*","edge://*","about:*","chrome-devtools://*","devtools://*","*://console.cloud.google.com/*","*://developers.google.com/*","*://apis.google.com/*","*://www.googleapis.com/*"],main(){if(location.protocol==="chrome:"||location.protocol==="chrome-extension:"||location.protocol==="moz-extension:"||location.protocol==="edge:"||location.protocol==="about:"||location.href.includes("chrome-devtools://")||location.href.includes("devtools://")||location.href.includes("console.cloud.google.com")||location.href.includes("developers.google.com")||location.href.includes("apis.google.com")||location.href.includes("www.googleapis.com")){console.log("[FNR] Extension disabled on restricted page:",location.href);return}console.log("[FNR] Content script starting on",location.href);const i=440,t=720;let n=i;window.fnrOpenSidebar=()=>p(),window.fnrDebug=()=>{var l;const e=document.getElementById("fake-news-reader-injected-sidebar");console.log("[FNR] debug",{exists:!!e,widthStyle:e==null?void 0:e.style.width,display:e==null?void 0:e.style.display,rect:(l=e==null?void 0:e.getBoundingClientRect)==null?void 0:l.call(e),bodyMarginRight:getComputedStyle(document.body).marginRight})},chrome.runtime.onMessage.addListener((e,l,r)=>{if((e==null?void 0:e.type)==="FNR_PING")return r({ok:!0}),!0}),chrome.runtime.onMessage.addListener(e=>{if((e==null?void 0:e.type)==="TOGGLE_INJECTED_SIDEBAR"&&(console.log("ðŸ”¥ðŸ”¥ðŸ”¥ SIDEBAR OPENER #4: CONTENT SCRIPT - TOGGLE MESSAGE RECEIVED ðŸ”¥ðŸ”¥ðŸ”¥"),console.log("[FNR] Toggle message received:",e),console.log("ðŸ“„ Has preloadedAnalysis:",!!e.preloadedAnalysis),console.log("ðŸ“„ Has hasPreloadedAnalysis flag:",!!e.hasPreloadedAnalysis),!!document.getElementById("fake-news-reader-injected-sidebar")?e.keepOpen?(console.log("ðŸ”¥ðŸ”¥ðŸ”¥ SIDEBAR OPENER #5: CONTENT SCRIPT - KEEPING SIDEBAR OPEN ðŸ”¥ðŸ”¥ðŸ”¥"),console.log("[FNR] Sidebar exists, keeping it open for analysis"),p(),e.preloadedAnalysis||e.hasPreloadedAnalysis?(console.log("âœ… Sending PRELOADED_ANALYSIS message to iframe"),setTimeout(()=>{const r=document.querySelector("#fake-news-reader-injected-sidebar iframe");r!=null&&r.contentWindow&&r.contentWindow.postMessage({type:"PRELOADED_ANALYSIS",data:e.preloadedAnalysis},"*")},50)):console.log("âŒ No preloaded analysis, would send TRIGGER_NEW_ANALYSIS")):(console.log("[FNR] Sidebar exists, toggling it closed"),D()):(console.log("ðŸ”¥ðŸ”¥ðŸ”¥ SIDEBAR OPENER #6: CONTENT SCRIPT - CREATING NEW SIDEBAR ðŸ”¥ðŸ”¥ðŸ”¥"),console.log("[FNR] Sidebar does not exist, creating it"),p(),e.preloadedAnalysis||e.hasPreloadedAnalysis?(console.log("âœ… TAKING PRELOADED PATH - Sending PRELOADED_ANALYSIS message to iframe (new sidebar)"),console.log("âœ… Will NOT send TRIGGER_NEW_ANALYSIS because we have preloaded data"),setTimeout(()=>{const r=document.querySelector("#fake-news-reader-injected-sidebar iframe");r!=null&&r.contentWindow&&(console.log("ðŸ“¤ Actually sending PRELOADED_ANALYSIS message now"),r.contentWindow.postMessage({type:"PRELOADED_ANALYSIS",data:e.preloadedAnalysis},"*"))},100)):(console.log("âŒ TAKING TRIGGER PATH - No preloaded analysis, sending TRIGGER_NEW_ANALYSIS"),setTimeout(()=>{const r=document.querySelector("#fake-news-reader-injected-sidebar iframe");r!=null&&r.contentWindow&&(console.log("ðŸ“¤ Actually sending TRIGGER_NEW_ANALYSIS message now"),r.contentWindow.postMessage({type:"TRIGGER_NEW_ANALYSIS"},"*"))},50)))),(e==null?void 0:e.type)==="EXPAND_FOR_ANALYSIS"){const l=e.expanded;n=l?t:i,l&&!document.getElementById("fake-news-reader-injected-sidebar")?(console.log("ðŸ”¥ðŸ”¥ðŸ”¥ SIDEBAR OPENER #7: CONTENT SCRIPT - EXPAND_FOR_ANALYSIS CREATING SIDEBAR ðŸ”¥ðŸ”¥ðŸ”¥"),p()):document.getElementById("fake-news-reader-injected-sidebar")&&L()}}),console.log("[FNR] Content script loaded"),chrome.runtime.onMessage.addListener((e,l,r)=>{if(e.type==="GET_PAGE_CONTENT"){const a=()=>setTimeout(()=>s(r),300);return document.readyState!=="complete"?window.addEventListener("load",a,{once:!0}):a(),!0}});function s(e){try{let l=null;l=document.querySelector("article"),l||(l=document.querySelector('main, [role="main" ]')),l||(l=document.querySelector(".article, .story, .post, .entry, .content-body")),l||(l=document.body);const r=l.cloneNode(!0);r.querySelectorAll('script, style, noscript, iframe, nav, header, footer, aside, .ads, [role="complementary"]').forEach(g=>g.remove());let d=Array.from(r.querySelectorAll("p")).map(g=>{var h;return((h=g.textContent)==null?void 0:h.trim())||""}).filter(Boolean).join(" ");d.length<200&&(d=(r.innerText||"").trim()),d=d.replace(/\s+/g," ").trim();const b=d.split(/\s+/).filter(Boolean).length;e({success:!0,data:{title:document.title,content:d,url:location.href,wordCount:b}})}catch{try{e({error:"Failed to extract page content."})}catch{}}}let o=null;const c=window.matchMedia("(prefers-reduced-motion: reduce)"),E=c.matches?0:160;function p(e){o||j(),o.style.opacity="1",L()}function j(){if(o||document.getElementById("fake-news-reader-injected-sidebar"))return;o=document.createElement("div"),o.id="fake-news-reader-injected-sidebar",o.setAttribute("aria-label","Fake News Reader Sidebar"),o.style.position="fixed",o.style.top="0",o.style.right="0",o.style.height="100vh",o.style.zIndex="2147483647",o.style.background="#fff",o.style.borderLeft="1px solid rgba(0,0,0,0.12)",o.style.boxShadow="0 0 0 1px rgba(0,0,0,0.06), -2px 0 8px rgba(0,0,0,0.06)",o.style.overflow="hidden",o.style.transition=`width ${E}ms ease, opacity ${E}ms ease`,o.style.display="block";const e=document.createElement("div");e.style.height="100%",e.style.display="flex",e.style.flexDirection="column";const l=document.createElement("div");l.style.cssText=["all: initial","display: flex","align-items: center","justify-content: space-between","padding: 12px 16px","border-bottom: 1px solid rgba(0,0,0,0.12)","box-sizing: border-box","width: 100%","background: #ffffff","box-shadow: 0 1px 3px rgba(0, 0, 0, 0.08)"].join(";");const r=document.createElement("div");console.log("NewsScan: Creating logo container"),r.style.cssText=["all: initial","display: flex","align-items: center","gap: 8px"].join(";");const a=document.createElement("img"),d=chrome.runtime.getURL("logo.png");console.log("NewsScan: Logo URL:",d),console.log("NewsScan: Chrome runtime ID:",chrome.runtime.id),a.src=d,a.alt="NewsScan Logo",a.style.cssText=["all: initial","width: 35px","height: 35px","object-fit: contain"].join(";"),a.onload=()=>{console.log("NewsScan: Logo loaded successfully")},a.onerror=T=>{console.error("NewsScan: Logo failed to load:",T),console.error("NewsScan: Logo URL that failed:",d),a.style.display="none"};const b=document.createElement("span");b.textContent="NewsScan",b.style.cssText=["all: initial","font: 600 15px system-ui, -apple-system, Segoe UI, Roboto","color: #202124","letter-spacing: -0.01em"].join(";"),console.log("NewsScan: Adding logo and title to container"),r.appendChild(a),r.appendChild(b);const g=document.createElement("button");g.setAttribute("aria-label","Close"),g.textContent="Ã—",g.style.cssText=["all: initial","display:inline-flex","align-items:center","justify-content:center","width:28px","height:28px","cursor:pointer","font: 600 16px/1 system-ui, -apple-system, Segoe UI, Roboto","color:#6b7280","background:transparent","border-radius: 4px"].join(";"),console.log("NewsScan: Adding logo container to header"),l.appendChild(r),l.appendChild(g);const h=document.createElement("div");h.style.flex="1",h.style.overflow="hidden";const m=document.createElement("iframe");m.title="NewsScan",m.style.border="0",m.style.width="100%",m.style.height="100%",m.src=chrome.runtime.getURL("sidepanel.html"),h.appendChild(m),g.onclick=()=>{var T;try{(T=m.contentWindow)==null||T.postMessage({type:"TRIGGER_RESET"},"*")}catch{}setTimeout(()=>{D()},50)},e.appendChild(l),e.appendChild(h),o.appendChild(e),document.documentElement.appendChild(o),L()}function D(){o&&(o.remove(),o=null,M())}function k(){document.documentElement.style.scrollBehavior="auto",document.body.style.transition=c.matches?"":`margin-right ${E}ms ease`,document.body.style.marginRight=`${n}px`}function M(){document.body.style.marginRight="",document.body.style.transition=""}function L(){o&&(o.style.width=`${n}px`,o.style.opacity="1",k())}}},N=(_=(P=globalThis.browser)==null?void 0:P.runtime)!=null&&_.id?globalThis.browser:globalThis.chrome;function A(i,...t){}const G={debug:(...i)=>A(console.debug,...i),log:(...i)=>A(console.log,...i),warn:(...i)=>A(console.warn,...i),error:(...i)=>A(console.error,...i)},R=class R extends Event{constructor(t,n){super(R.EVENT_NAME,{}),this.newUrl=t,this.oldUrl=n}};f(R,"EVENT_NAME",v("wxt:locationchange"));let x=R;function v(i){var t;return`${(t=N==null?void 0:N.runtime)==null?void 0:t.id}:content:${i}`}function F(i){let t,n;return{run(){t==null&&(n=new URL(location.href),t=i.setInterval(()=>{let s=new URL(location.href);s.href!==n.href&&(window.dispatchEvent(new x(s,n)),n=s)},1e3))}}}const w=class w{constructor(t,n){f(this,"isTopFrame",window.self===window.top);f(this,"abortController");f(this,"locationWatcher",F(this));f(this,"receivedMessageIds",new Set);this.contentScriptName=t,this.options=n,this.abortController=new AbortController,this.isTopFrame?(this.listenForNewerScripts({ignoreFirstEvent:!0}),this.stopOldScripts()):this.listenForNewerScripts()}get signal(){return this.abortController.signal}abort(t){return this.abortController.abort(t)}get isInvalid(){return N.runtime.id==null&&this.notifyInvalidated(),this.signal.aborted}get isValid(){return!this.isInvalid}onInvalidated(t){return this.signal.addEventListener("abort",t),()=>this.signal.removeEventListener("abort",t)}block(){return new Promise(()=>{})}setInterval(t,n){const s=setInterval(()=>{this.isValid&&t()},n);return this.onInvalidated(()=>clearInterval(s)),s}setTimeout(t,n){const s=setTimeout(()=>{this.isValid&&t()},n);return this.onInvalidated(()=>clearTimeout(s)),s}requestAnimationFrame(t){const n=requestAnimationFrame((...s)=>{this.isValid&&t(...s)});return this.onInvalidated(()=>cancelAnimationFrame(n)),n}requestIdleCallback(t,n){const s=requestIdleCallback((...o)=>{this.signal.aborted||t(...o)},n);return this.onInvalidated(()=>cancelIdleCallback(s)),s}addEventListener(t,n,s,o){var c;n==="wxt:locationchange"&&this.isValid&&this.locationWatcher.run(),(c=t.addEventListener)==null||c.call(t,n.startsWith("wxt:")?v(n):n,s,{...o,signal:this.signal})}notifyInvalidated(){this.abort("Content script context invalidated"),G.debug(`Content script "${this.contentScriptName}" context invalidated`)}stopOldScripts(){window.postMessage({type:w.SCRIPT_STARTED_MESSAGE_TYPE,contentScriptName:this.contentScriptName,messageId:Math.random().toString(36).slice(2)},"*")}verifyScriptStartedEvent(t){var c,E,p;const n=((c=t.data)==null?void 0:c.type)===w.SCRIPT_STARTED_MESSAGE_TYPE,s=((E=t.data)==null?void 0:E.contentScriptName)===this.contentScriptName,o=!this.receivedMessageIds.has((p=t.data)==null?void 0:p.messageId);return n&&s&&o}listenForNewerScripts(t){let n=!0;const s=o=>{if(this.verifyScriptStartedEvent(o)){this.receivedMessageIds.add(o.data.messageId);const c=n;if(n=!1,c&&(t!=null&&t.ignoreFirstEvent))return;this.notifyInvalidated()}};addEventListener("message",s),this.onInvalidated(()=>removeEventListener("message",s))}};f(w,"SCRIPT_STARTED_MESSAGE_TYPE",v("wxt:content-script-started"));let C=w;function U(){}function I(i,...t){}const O={debug:(...i)=>I(console.debug,...i),log:(...i)=>I(console.log,...i),warn:(...i)=>I(console.warn,...i),error:(...i)=>I(console.error,...i)};return(async()=>{try{const{main:i,...t}=u,n=new C("content",t);return await i(n)}catch(i){throw O.error('The content script "content" crashed on startup!',i),i}})()}();
content;
